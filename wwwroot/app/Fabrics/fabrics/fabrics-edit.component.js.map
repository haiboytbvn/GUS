{"version":3,"sources":["Fabrics/fabrics/fabrics-edit.component.ts"],"names":["FabricsEditComponent","fb","fabricsService","categoryService","productnameService","yarncountService","finishingService","fibrecontentService","fabtypeService","brandService","departmentService","divisionService","router","weightService","producttypeService","colorService","authService","activatedRoute","this","title","errorMessage","isDelete","isFormValuesChanged","prototype","changeCategory","_this","getFabProductNameByCategory","jQuery","val","subscribe","items","productnames","error","changeType","id","disableCategory","disableProductName","getFabCateogryListByType","categories","ngOnInit","isLoggedIn","navigate","snapshot","params","get","data","searchGeneralFilter_model_1","SearchGeneralFilter","paging","pagination_model_1","PaginationModel","searchModel","generalsearch_model_1","GeneralSearchModel","pageall","getAll","getFabricsCategoryList","Data","getFabricsTypeList","fabtypes","getFabricsProductNameList","getBrandList","brands","getDepartmentList","departments","getDivisionList","divisions","getColorList","colors","getFabricsYarnCountList","yarncounts","getFabricsFinishingList","finishings","getFabricProductTypeList","producttypes","getFabricWeightList","weights","getFabricsFibreContentList","fibrecontents","iseditting","buttonvalue","onUpdate","Image","update","alert","fileChangeEvent","fileUpload","files","FormData","i","length","append","name","ajax","type","url","contentType","processData","success","prop","UploadPath","mainimage","imagepath","appendstring","html","isFormChanged","value","Id","oldData","isFormDataChanged","changeImage","path","JSON","stringify","__decorate","core_1","ViewChild","Component","selector","templateUrl","providers","fabricweight_service_1","FabricWeightService","fabricproducttype_service_1","FabricProductTypeService","fabricstype_service_1","FabricsTypeService","color_service_1","ColorService","fabric_service_1","FabricsService","forms_1","FormBuilder","fabricscategory_service_1","FabricsCategoryService","fabricsproductname_service_1","FabricsProductNameService","fabricsyarncount_service_1","FabricsYarnCountService","fabricsfinishing_service_1","FabricsFinishingService","fabricsfibrecontent_service_1","FabricsFibreContentService","Validators","department_service_1","DepartmentService","brand_service_1","BrandService","division_service_1","DivisionService","exports_1"],"mappings":"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","file":"fabrics-edit.component.js","sourcesContent":["import { Component, OnInit, ViewChild, ElementRef, AfterViewInit } from \"@angular/core\";\nimport { FormBuilder, FormControl, FormGroup, Validators } from \"@angular/forms\";\nimport { Router, ActivatedRoute } from \"@angular/router\";\nimport { Fabrics } from \"../../Fabrics/shared/fabric.model\";\nimport { FabricsService } from \"../../Fabrics/shared/fabric.service\";\nimport { FabricsCategoryService } from \"../../FabricsCategory/shared/fabricscategory.service\";\nimport { FabricsCategory } from \"../../FabricsCategory/shared/fabricscategory.model\";\nimport { FabricsProductName } from \"../../FabricsProductName/shared/fabricsproductname.model\";\nimport { FabricsProductNameService } from \"../../FabricsProductName/shared/fabricsproductname.service\";\nimport { FabricsYarnCountService } from \"../../FabricsYarnCount/shared/fabricsyarncount.service\";\nimport { FabricsYarnCount } from \"../../FabricsYarnCount/shared/fabricsyarncount.model\";\nimport { FabricsFinishing } from \"../../FabricsFinishing/shared/fabricsfinishing.model\";\nimport { FabricsFinishingService } from \"../../FabricsFinishing/shared/fabricsfinishing.service\";\nimport { FabricsFibreContentService } from \"../../FabricsFibreContent/shared/fabricsfibrecontent.service\";\nimport { FabricsFibreContent } from \"../../FabricsFibreContent/shared/fabricsfibrecontent.model\";\nimport { FabricsType } from \"../../FabricsType/shared/fabricstype.model\";\nimport { FabricsTypeService } from \"../../FabricsType/shared/fabricstype.service\";\nimport { Department } from \"../../Department/shared/department.model\";\nimport { DepartmentService } from \"../../Department/shared/department.service\";\nimport { Division } from \"../../Division/shared/division.model\";\nimport { DivisionService } from \"../../Division/shared/division.service\";\nimport { Brand } from \"../../Brand/shared/brand.model\";\nimport { FabricWeight } from \"../../FabricWeight/shared/fabricweight.model\";\nimport { FabricWeightService } from \"../../FabricWeight/shared/fabricweight.service\";\nimport { BrandService } from \"../../Brand/shared/brand.service\";\nimport { AuthService } from \"../../auth.service\";\nimport { SearchGeneralFilter } from \"../../SearchGeneralFilter/shared/searchGeneralFilter.model\";\nimport { Color } from \"../../Color/shared/color.model\";\r\nimport { ColorService } from \"../../Color/shared/color.service\";\r\nimport { ColorSearchModel } from \"../../Color/shared/color-search.model\"; \nimport { GeneralSearchModel } from \"../../Pagination/shared/generalsearch.model\";\r\nimport { PaginationModel } from \"../../Pagination/shared/pagination.model\";\nimport { FabricProductType } from \"../../FabricProductType/shared/fabricproducttype.model\";\nimport { FabricProductTypeService } from \"../../FabricProductType/shared/fabricproducttype.service\";\ndeclare var jQuery: any;\n\n@Component({\n    selector: \"fabrics-edit\",\n    templateUrl:\"app/Fabrics/fabrics/fabrics-edit.component.html\",\n    providers: [FabricWeightService,FabricProductTypeService,FabricsTypeService,ColorService,FabricsService, FormBuilder, FabricsCategoryService, FabricsProductNameService, FabricsYarnCountService, FabricsFinishingService, FabricsFibreContentService, Validators, DepartmentService, BrandService, DivisionService, FabricsTypeService]\n})\n\nexport class FabricsEditComponent {\n    data: Fabrics;\n    title = \"Edit Fabrics\";\n    fabricsForm: FormGroup;\n    errorMessage = null;\n    @ViewChild('errorDiv') errorDiv: ElementRef;\n    isDelete = false;\n    isFormValuesChanged = false;\n    oldData: Fabrics;\n    categories: FabricsCategory[];\n    productnames: FabricsProductName[];\n    yarncounts: FabricsYarnCount[];\n    finishings: FabricsFinishing[];\n    fabtypes: FabricsType[];\n    brands: Brand[];\n    divisions: Division[];\n    departments: Department[];\n    fibrecontents: FabricsFibreContent[];\n    colors: Color[];\n    producttypes: FabricProductType[];\n    weights: FabricWeight[];\n    searchModel: GeneralSearchModel;\r\n    paging: PaginationModel;\n    iseditting: boolean;\n    buttonvalue: string;\n    disableProductName: boolean;\r\n    disableCategory: boolean;\n    constructor(\n        private fb: FormBuilder,\n        private fabricsService: FabricsService,\n        private categoryService: FabricsCategoryService,\n        private productnameService: FabricsProductNameService,\n        private yarncountService: FabricsYarnCountService,\n        private finishingService: FabricsFinishingService,\n        private fibrecontentService: FabricsFibreContentService,\n        private fabtypeService: FabricsTypeService,\n        private brandService: BrandService,\n        private departmentService: DepartmentService,\n        private divisionService: DivisionService,\n        private router: Router,\n        private weightService: FabricWeightService,\n        private producttypeService: FabricProductTypeService,\n        private colorService: ColorService,\n        private authService: AuthService,\n        private activatedRoute: ActivatedRoute) {\n\n    }\n    changeCategory() {\n        this.productnameService.getFabProductNameByCategory(jQuery('#drFabcategory').val()).subscribe(items => this.productnames = items, error => this.errorMessage = <any>error);\n    }\n    changeType(id: string) {\n        if (id === \"\") {\r\n\r\n            this.disableCategory = true;\r\n            this.disableProductName = true;\r\n        } else {\r\n\r\n            this.disableCategory = false;\r\n            this.categoryService.getFabCateogryListByType(id).subscribe(items => this.categories = items, error => this.errorMessage = <any>error);\r\n        }\r\n\n\n    }\n    ngOnInit() {\n        if (!this.authService.isLoggedIn()) {\r\n            this.router.navigate([\"\"]);\r\n        }\n        this.disableCategory = true;\r\n        this.disableProductName = true;\n        var id = this.activatedRoute.snapshot.params[\"id\"];\n        if (id) {\n            this.fabricsService.get(id).subscribe((data) => {\n                this.data = data;\n            });\n        }\n        else {\n            this.router.navigate([\"fabrics/add\"]);\n        }\n\n        var searchGeneralFilter = new SearchGeneralFilter(\"\", \"\", \"\", \"\");\n        this.paging = new PaginationModel(10, 1, \"Name\", 0, [], 0);\r\n        this.searchModel = new GeneralSearchModel(\"\", \"\", \"\", \"\", this.paging);\n\n        var pageall = new PaginationModel(10, 0, \"Name\", 0, [], 0);\r\n        var getAll = new GeneralSearchModel(\"\", \"\", \"\", \"\", pageall);\n\n        this.categoryService.getFabricsCategoryList(getAll).subscribe(items => this.categories = items.Data, error => this.errorMessage = <any>error);\n        this.fabtypeService.getFabricsTypeList(getAll).subscribe(items => this.fabtypes = items.Data, error => this.errorMessage = <any>error);\n        this.productnameService.getFabricsProductNameList(getAll).subscribe(items => this.productnames = items.Data, error => this.errorMessage = <any>error);\n        this.brandService.getBrandList(getAll).subscribe(items => this.brands = items.Data, error => this.errorMessage = <any>error);\n        this.departmentService.getDepartmentList(getAll).subscribe(items => this.departments = items.Data, error => this.errorMessage = <any>error);\n        this.divisionService.getDivisionList(getAll).subscribe(items => this.divisions = items.Data, error => this.errorMessage = <any>error);\n        this.colorService.getColorList(getAll).subscribe(items => this.colors = items.Data, error => this.errorMessage = <any>error);\n        this.yarncountService.getFabricsYarnCountList(getAll).subscribe(items => this.yarncounts = items.Data, error => this.errorMessage = <any>error);\n        this.finishingService.getFabricsFinishingList(getAll).subscribe(items => this.finishings = items.Data, error => this.errorMessage = <any>error);\n        this.producttypeService.getFabricProductTypeList(getAll).subscribe(items => this.producttypes = items.Data, error => this.errorMessage = <any>error);\n        this.weightService.getFabricWeightList(getAll).subscribe(items => this.weights = items.Data, error => this.errorMessage = <any>error);\n        this.fibrecontentService.getFabricsFibreContentList(getAll).subscribe(items => this.fibrecontents = items.Data, error => this.errorMessage = <any>error);\n        this.title = \"Edit Fabric\";\n        this.iseditting = false;\n        this.buttonvalue = \"Edit\";\n    }\n\n    onUpdate(data: Fabrics) {\n        if (this.iseditting) {\n            data.Image = jQuery('#hdImagepath').val();\n            this.fabricsService.update(data).subscribe((data) => {\n                if (data.error == null) {\n                    this.data = data;\n                    alert('Fabric detail updated successfully');\n                    this.router.navigate([\"/fabrics\"]);\n\n                } else {\n                    // update failure\n                    this.errorMessage = data.error;\n                    alert(this.errorMessage);\n                }\n            },\n                (error) => {\n                    this.errorMessage = error;\n\n                }\n            );\n        } else {\n            this.buttonvalue = \"Save\";\n            this.iseditting = true;\n        }\n    }\n    fileChangeEvent() {\n\n        var fileUpload = jQuery(\"#files\").get(0);\r\n        var files = fileUpload.files;\r\n        var data = new FormData();\r\n        for (var i = 0; i < files.length; i++) {\r\n            data.append(files[i].name, files[i]);\r\n        }\r\n        jQuery.ajax({\r\n            type: \"POST\",\r\n            url: \"api/fabric/UploadImage\",\r\n            contentType: false,\r\n            processData: false,\r\n            data: data,\r\n            success: function (data) {\r\n                jQuery('#imgPreview').prop(\"src\", data[0].UploadPath);\r\n                this.mainimage = data[0].UploadPath;\r\n                var imagepath = \"\";\r\n                var appendstring = \"\";\n                for (var i = 0; i < data.length; i++) {\r\n\r\n                    imagepath += data[i].UploadPath + \"|\";\r\n                    appendstring += \"<li><a href=\\\"javascript:void(0);\\\" [(click)]=\\\"changeImage(\" + data[i].UploadPath + \")\\\"><img src=\\\"\" + data[i].UploadPath + \"\\\" alt=\\\"accessory image\\\"></a></li>\"\r\n                    // this.listimages.push(data[i].UploadPath);\r\n                }\n                jQuery('#hdImage').val(imagepath);\r\n                jQuery('#imagecontainer').html('');\n                jQuery('#imagecontainer').html(appendstring);\n                this.data.Image = imagepath;\r\n            },\r\n            error: function () {\r\n                alert(\"There was error uploading files!\");\r\n            }\r\n        });\r\n\r\n\n    }\n   \n\n\n\n    isFormChanged(value) {\n        this.fabricsService.get(this.data.Id).subscribe((oldData) => {\n            this.isFormDataChanged(oldData);\n        });\n    }\n    changeImage(path: string) {\n        jQuery('#imgPreview').prop(\"src\", path);\n    }\n    isFormDataChanged(oldData: Fabrics) {\n        if (JSON.stringify(this.data) === JSON.stringify(oldData))\n            this.isFormValuesChanged = false;\n        else\n            this.isFormValuesChanged = true;\n    }\n}"]}